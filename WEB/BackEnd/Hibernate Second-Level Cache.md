# Hibernate Second-Level Cache

## 개요

JPA에서는 1차 캐시를 사용하고 이는 영속성 컨텍스트에 존재한다. 그렇기 때문에 트랜잭션이 종료되면 1차 캐시도 종료된다.

만약에 캐싱의 스코프를 넓혀서 애플리케이션 범위로 사용할 수 있다면 DB를 호출하지 않고 캐싱된 엔티티를 사용하여 성능을 개선할 수 있지 않을까?

## 2차 캐시

영속성 컨텍스트는 엔티티가 필요하면 2차 캐시를 조회한다.

2차 캐시에 엔티티가 없다면 데이터베이스에 조회하고 2차 캐시에 저장한다.

2차 캐시는 자신이 보관하고있는 엔티티를 복사해서 반환한다.  
2차 캐시는 데이터베이스 기본 키를 기준으로 캐시하지만 영속성 컨텍스트가 다르면 객체 동일성을 보장하지 않는다.

2차 캐시의 전략은 여러가지가 있다.

* READ_ONLY : 읽기 전용
* READ_WRITE : 읽고 쓰기 전용
* NONSTRICT_READ_WRITE : 변경이 거의 없는 경우 사용

## 실제론?

인프런을 찾아봤는데 실무에서는 적용하지 않는다고 한다.  
2차 캐시는 엔티티만 캐시가 되기 때문에 서비스단에서 캐싱하는 것의 이점과 비교했을 때 큰 메리츠가 없고 설정이 복잡한 단점이 있다고 한다.
