# Animation

## 개요

웹 사이트를 이용하다보면 화면안의 요소들이 자연스럽게 바뀌는 경우를 볼 수 있다. 위치가 이동되거나 크기나 색상이 변경되거나 한다.

웹 사이트에서 보여지는 이미지 슬라이드도 마찬가지이다.

이러한 효과를 애니메이션이라고 한다.

처음 HTML/CSS를 배우고 간단한 웹 페이지를 만들어 봤다면 이러한 동작이 어떻게 가능한지 궁금할 수 있다.


## CSS선언을 이용한 애니메이션

HTML 요소의 동적인 동작은 Javascript로 하는 것이라는 말을 들은 적이 있을 것이다. 그러나 CSS로 애니메이션을 처리할 수도 있다. 이는 조금 특이케이스라고도 볼 수 있겠다.

버튼을 하나 만들고 CSS를 선언한다.

```css
.btn {
  width : 180px;
  height : 60px;
  background-color : #fff
}
```

그리고 마우스를 버튼에 올렸을 때 동작하는 hover 가상선택자를 선언해준다.

```css
.btn:hover {
  background-color : #333;
}
```

이렇게 작성하면 마우스를 올렸을 경우 버튼의 색상이 변하는 것을 볼 수 있다. 그러나 색상이 즉각 변하기 때문에 애니메이션 효과라고는 보기 힘들다.

그래서 필요한 속성이 바로 transition 속성이다.

transition속성은 요소가 변화할 때 몇 초에 걸쳐서 변화하도록 할 수 있다.

예를 들어 transition : .4s; 라고 선언하면 버튼의 배경 색이 0.4초에 걸쳐 변화한다.


## Javascript를 이용한 애니메이션

자바스크립트를 이용한 애니메이션 방법은 일정한 시간 간격으로 함수를 실행시키는 `setInterval()` 함수를 이용할 수 있다.

그러나 이 방식의 단점은 `setInterval()`의 호출이 비동기적으로 일어나기 때문에 중간에 동기적인 이벤트가 생길 경우 우선순위에서 밀려 정해진 시간에 함수가 호출되는 것이 아니게 될 수 있다.

![setInterval](https://cphinf.pstatic.net/mooc/20180205_116/1517816517181oVblH_PNG/3-4-1_setInterval.png?type=w760)

다른 방법으로는 `setTimeout()` 함수를 이용하는 방법이 있다.

애니메이션을 구현하려면 재귀호출을 하면 된다.

예를 들면 다음과 같다.

```js
let count = 0;
function animate() {   
  setTimeout(() => {
    if(count >= 20) return;
    console.log('현재시각은', new Date());
    count++;
    animate();
  },500);
}
animate();
```

한 번의 함수 실행이 끝나면 다시 자기 자신을 호출시킨다.
스택 오버플로우는 일어나지 않는다.

장점은 하나가 실행이 끝난 뒤에 실행되기 때문에 먹히지 않는다.

그러나 이처럼 연속적인 함수 호출로 애니메이션을 구현하는 방법은 애초에 애니메이션을 위해 생겨난 메소드가 아니기 때문에 끊기는 느낌을 줄 수 있고 주기를 16.6 미만으로 하는 경우 불필요한 프레임이 생성되는 등의 문제가 있다.

이를 위해(애니메이션 처리) 존재하는 메소드가 바로 `requestAnimationFrame`이다.

`requestAnimationFrame`을 일단 한 번 실행시키고 특정 조건이 될 때까지 함수를 연속적으로 호출하는 식으로 작동한다.

원하는 함수를 인자로 넣어주면 브라우저는 인자로 받은 비동기 함수가 실행될 적절할 타이밍에 실행시켜준다.






